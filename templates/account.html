{% extends "layout.html" %}
{% block title %} Account {% endblock %}

{% block main %}
    
    <table class="table table-striped">
        <thead>
            <tr>
                <th>Class</th>
                <th>Registration</th>
                <th>Registration status</th>
            </tr>
        </thead>
        
        {% for week in weeks %}
            <tr>
                <td>Week {{ week }}</td>
                <td>
                    <!-- paid -->
                    {% if (week in status) and (status[week][1] != 0) %}
                        <form>
                            <button type="submit" class="btn btn-secondary" disabled>Register and Pay</button>
                        </form>
                        <form>
                            <button type="submit" name="{{ week }}" class="btn btn-secondary" disabled>Register Now</button>
                        </form>
                    {% else %}
                        <form method="GET" action="/payment">
                            <input type="hidden" name="week" value="{{ week }}">
                            <button type="submit" class="btn btn-primary">Register and Pay</button>
                        </form>
                        <form method="POST" action="/account" onsubmit="return confirmUpdate('{{ week }}', '{{ payment }}')">
                            <button type="submit" name="{{ week }}" class="btn btn-primary">Register Now</button>
                        </form>
                    {% endif %}
                </td>
                <td>
                    {% if (week in status) and (status[week][1] != 0) %}
                        <p>✅ Registered</p>
                    {% else %}
                        <p>❌ Not Registered</p>
                    {% endif %}
                </td>
            </tr>
        {% endfor %}
    </table>

    <script>
        function confirmUpdate(week, price) {
            // Display a confirmation dialog
            var msg = "Are you sure you want to register for week " + week + " for $" + price + "?";
            var confirmed = confirm(msg);
            return confirmed;
        }
    </script>

{% endblock %}
